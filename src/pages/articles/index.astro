---
import { getCollection } from 'astro:content';
import Layout from '../../layouts/Layout.astro';
import UnsplashImage from '../../components/UnsplashImage.astro';

// Get all articles
const articles = await getCollection('articles');

// Sort articles by publication date (from newest to oldest)
articles.sort((a, b) => b.data.date.valueOf() - a.data.date.valueOf());
---

<Layout title="Apology Articles" description="Browse our collection of apology articles">
  <main class="container mx-auto px-4 py-8">
    <h1 class="text-4xl font-bold mb-8 text-center">Apology Articles</h1>
    <ul class="space-y-12">
      {articles.map((article) => (
        <li class="bg-white shadow-md rounded-lg overflow-hidden">
          {article.data.image && (
            <div class="aspect-video">
              <UnsplashImage article={article} />
            </div>
          )}
          <div class="p-6">
            <h2 class="text-2xl font-semibold mb-2">
              <a href={`/articles/${article.slug}`} class="text-blue-600 hover:text-blue-800 transition duration-300">
                {article.data.title}
              </a>
            </h2>
            <p class="text-gray-600 mb-4">{article.data.description}</p>
            <time datetime={article.data.date.toISOString()} class="text-sm text-gray-500">
              {article.data.date.toLocaleDateString()}
            </time>
          </div>
        </li>
      ))}
    </ul>
  </main>
</Layout>

<style>
  .aspect-video {
    aspect-ratio: 16 / 9;
  }
  .aspect-video img {
    width: 100%;
    height: 100%;
    object-fit: cover;
  }
</style>
