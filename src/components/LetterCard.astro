---
import type { Letter } from '../lib/db';

interface Props {
  letter: Letter;
  slug: string;
}

const { letter, slug } = Astro.props;

function truncateText(text: string, maxLength: number): string {
  if (text.length <= maxLength) return text;
  return text.slice(0, maxLength) + '...';
}
---

<article
  class="card bg-base-100 shadow-xl hover:shadow-2xl transition-all duration-300 group example-card border border-base-300 hover:border-primary"
  data-recipient={letter.recipient}
  data-tone={letter.tone}
>
  <a href={`/examples/${letter.recipient}/${slug}`} class="card-body p-6">
    <!-- Header con badges -->
    <div class="flex gap-2 mb-3">
      <div class="badge badge-primary badge-sm">
        {letter.recipient.charAt(0).toUpperCase() + letter.recipient.slice(1)}
      </div>
      <div class="badge badge-secondary badge-sm">
        {letter.tone.charAt(0).toUpperCase() + letter.tone.slice(1)}
      </div>
    </div>

    <!-- Título -->
    <h2 class="card-title text-base group-hover:text-primary transition-colors line-clamp-2">
      {letter.title || letter.context}
    </h2>

    <!-- Preview del contenido -->
    <p class="text-sm opacity-70 line-clamp-3 flex-grow">
      {truncateText(letter.letters[0], 150)}
    </p>

    <!-- Footer con acción -->
    <div class="card-actions justify-between items-center mt-4 pt-4 border-t border-base-300">
      <div class="text-xs opacity-60">
        {letter.letters.length} {letter.letters.length === 1 ? 'example' : 'examples'}
      </div>
      <div class="flex items-center gap-2 text-primary group-hover:gap-3 transition-all">
        <span class="text-sm font-medium">Read more</span>
        <svg class="w-4 h-4" fill="none" viewBox="0 0 24 24" stroke="currentColor">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7" />
        </svg>
      </div>
    </div>
  </a>
</article>

<style>
  .line-clamp-2 {
    display: -webkit-box;
    -webkit-line-clamp: 2;
    -webkit-box-orient: vertical;
    overflow: hidden;
  }

  .line-clamp-3 {
    display: -webkit-box;
    -webkit-line-clamp: 3;
    -webkit-box-orient: vertical;
    overflow: hidden;
  }
</style> 